import{E as e,H as t,L as a,I as n,Q as i,D as o,R as s,T as r,a as d}from"./vendor.871f4f88.js";function l(e,t=document){return t.querySelector(e)}function c(e,t=document){return Array.from(t.querySelectorAll(e))}!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const n=new URL(e,location),i=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,o)=>{const s=new URL(e,n);if(self[t].moduleMap[s])return a(self[t].moduleMap[s]);const r=new Blob([`import * as m from '${s}';`,`${t}.moduleMap['${s}']=m;`],{type:"text/javascript"}),d=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(r),onerror(){o(new Error(`Failed to import: ${e}`)),i(d)},onload(){a(self[t].moduleMap[s]),i(d)}});document.head.appendChild(d)})),self[t].moduleMap={}}}("/build/assets/");const u=['a[href]:not([disabled]):not([tabindex="-1"])','button:not([disabled]):not([tabindex="-1"])','textarea:not([disabled]):not([tabindex="-1"])','input:not([type="hidden"]):not([disabled]):not([tabindex="-1"])','select:not([disabled]):not([tabindex="-1"])'];function h(e,t,a){document.addEventListener(e,(e=>{const n=e.target.closest(t);n&&a({event:e,target:n})}))}function m(){}async function p(e,t){e.classList.add(`${t}-leave`),e.classList.add(`${t}-leave-start`),await v(),e.classList.remove(`${t}-leave-start`),e.classList.add(`${t}-leave-end`),await g(e),e.classList.remove(`${t}-leave-end`),e.classList.remove(`${t}-leave`),e.classList.add("hidden"),await v()}function g(e){return new Promise((t=>{const a=1e3*Number(getComputedStyle(e).transitionDuration.replace("s",""));setTimeout((()=>{t()}),a)}))}function v(){return new Promise((e=>{requestAnimationFrame((()=>{requestAnimationFrame(e)}))}))}async function b(e,t){return(await fetch(e,{method:"POST",body:t,credentials:"same-origin",headers:{"X-CSRF-Token":l('[name="_token"]').value}})).json()}async function f(e,t){const a=await fetch(e,{method:"POST",body:JSON.stringify({data:t}),credentials:"same-origin",headers:{"Content-Type":"application/json","X-CSRF-Token":l('[name="_token"]').value}});return(await a.json()).html}function w(e,{onConfirm:t=m,onDismiss:a=m}={}){const n=l(`[data-modal="${e}"]`);!async function(e,t){e.classList.remove("hidden"),e.classList.add(`${t}-enter`),e.classList.add(`${t}-enter-start`),await v(),e.classList.remove(`${t}-enter-start`),e.classList.add(`${t}-enter-end`),await g(e),e.classList.remove(`${t}-enter-end`),e.classList.remove(`${t}-enter`),await v()}(n,"fade");L(n,{onConfirm:t,onDismiss:a,onClose:function(e){const t=c(u.join(", "),e),a=t[0],n=t[t.length-1];function i(e){"Tab"===e.key&&(e.shiftKey?document.activeElement===a&&(e.preventDefault(),n.focus()):document.activeElement===n&&(e.preventDefault(),a.focus()))}return a&&a.focus(),window.addEventListener("keydown",i),()=>{window.removeEventListener("keydown",i)}}(n)}),E(!0)}function E(e){window.history.replaceState({},"",window.location.pathname+window.location.search+(e?"#modal":""))}function L(e,{onConfirm:t,onDismiss:a,onClose:n}){function i(t){"Escape"===t.key&&e.dispatchEvent(new Event("dismiss"))}function o(){t(),r(),p(e,"fade")}function s(){a(),r(),p(e,"fade")}function r(){n(),window.removeEventListener("keydown",i),e.removeEventListener("confirm",o),e.removeEventListener("dismiss",s),E(!1)}window.addEventListener("keydown",i),e.addEventListener("confirm",o),e.addEventListener("dismiss",s)}if(h("click","[data-modal-trigger]",(({target:e})=>{w(e.dataset.modalTrigger)})),h("click","[data-modal-confirm]",(({target:e})=>{e.closest("[data-modal]").dispatchEvent(new Event("confirm"))})),h("click","[data-modal-dismiss]",(({target:e})=>{e.closest("[data-modal]").dispatchEvent(new Event("dismiss"))})),h("click","[data-modal-backdrop]",(({event:e,target:t})=>{if(e.target===t){t.closest("[data-modal]").dispatchEvent(new Event("dismiss"))}})),document.addEventListener("turbolinks:load",(()=>{c("[data-modal]").filter((e=>!e.classList.contains("hidden"))).forEach((e=>{L(e,{onConfirm:m,onDismiss:m,onClose:m})}))})),window.location.hash.includes("#modal")){const e=document.querySelector("[data-modal]");if(e){w(e.getAttribute("data-modal"))}}
/**
 * CodeTool for Editor.js
 *
 * @author CodeX (team@ifmo.su)
 * @copyright CodeX 2018
 * @license MIT
 * @version 2.0.0
 */
class y{static get isReadOnlySupported(){return!0}static get enableLineBreaks(){return!0}constructor({data:e,config:t,api:a,readOnly:n}){this.api=a,this.readOnly=n,this.placeholder=this.api.i18n.t(t.placeholder||y.DEFAULT_PLACEHOLDER),this.CSS={baseClass:this.api.styles.block,input:this.api.styles.input,wrapper:"ce-code",textarea:"ce-code__textarea"},this.nodes={holder:null,textarea:null,language:null,theme:null},this.data={code:e.code||"",language:e.language||"",theme:e.theme||"default"},this.nodes.holder=this.drawView()}drawView(){const e=document.createElement("div"),t=document.createElement("textarea"),a=document.createElement("input"),n=document.createElement("select");e.classList.add(this.CSS.baseClass,this.CSS.wrapper),t.classList.add(this.CSS.textarea,this.CSS.input),t.placeholder=this.placeholder,t.textContent=this.data.code,a.classList.add(this.CSS.input),a.value=this.data.language,a.placeholder="Language",n.classList.add(this.CSS.input,"theme-selector"),this.readOnly&&(t.disabled=!0,a.disabled=!0);const i=document.createElement("div");i.appendChild(a),i.appendChild(n),i.classList.add("grid","grid-cols-2","gap-4","mt-4"),e.appendChild(i),e.appendChild(t),t.addEventListener("keydown",(e=>{switch(e.code){case"Tab":this.tabHandler(e)}}));const o=document.createElement("option");o.setAttribute("disabled",!0),o.setAttribute("selected",!0),o.textContent="Select a theme",n.appendChild(o);const s=["a11y-dark","a11y-light","agate","an-old-hope","androidstudio","arduino-light","arta","ascetic","atelier-cave-dark","atelier-cave-light","atelier-dune-dark","atelier-dune-light","atelier-estuary-dark","atelier-estuary-light","atelier-forest-dark","atelier-forest-light","atelier-heath-dark","atelier-heath-light","atelier-lakeside-dark","atelier-lakeside-light","atelier-plateau-dark","atelier-plateau-light","atelier-savanna-dark","atelier-savanna-light","atelier-seaside-dark","atelier-seaside-light","atelier-sulphurpool-dark","atelier-sulphurpool-light","atom-one-dark","atom-one-dark-reasonable","atom-one-light","brown-paper","codepen-embed","color-brewer","darcula","dark","darkula","default","docco","dracula","far","foundation","github","github-gist","gml","googlecode","gradient-dark","grayscale","gruvbox-dark","gruvbox-light","hopscotch","hybrid","idea","ir-black","isbl-editor-dark","isbl-editor-light","kimbie.dark","kimbie.light","lightfair","magula","mono-blue","monokai","monokai-sublime","night-owl","nord","obsidian","ocean","paraiso-dark","paraiso-light","pojoaque","pojoaque.jpg","purebasic","qtcreator_dark","qtcreator_light","railscasts","rainbow","routeros","school-book","shades-of-purple","solarized-dark","solarized-light","sunburst","tomorrow","tomorrow-night","tomorrow-night-blue","tomorrow-night-bright","tomorrow-night-eighties","vs","vs2015","xcode","xt256","zenburn"];for(let r=0;r<s.length;r++){const e=document.createElement("option"),t=s[r];"string"==typeof t?(e.setAttribute("value",t),e.textContent=t):(e.setAttribute("value",t.value),e.textContent=t.label),n.appendChild(e)}return""!==this.data.theme&&(n.value=this.data.theme),n.addEventListener("change",(e=>{document.querySelectorAll(".theme-selector").forEach((t=>{t.value=e.target.value}))})),this.nodes.textarea=t,this.nodes.language=a,this.nodes.theme=n,e}render(){return this.nodes.holder}save(e){return{code:e.querySelector("textarea").value,language:e.querySelector("input").value,theme:document.querySelector(".theme-selector").value}}onPaste(e){const t=e.detail.data;this.data={code:t.textContent}}get data(){return this._data}set data(e){this._data=e,this.nodes.textarea&&(this.nodes.textarea.textContent=e.code),this.nodes.language&&(this.nodes.language.value=e.language),this.nodes.theme&&(this.nodes.theme.value=e.theme)}static get toolbox(){return{icon:'<svg width="14" height="14" viewBox="0 -1 14 14" xmlns="http://www.w3.org/2000/svg" > <path d="M3.177 6.852c.205.253.347.572.427.954.078.372.117.844.117 1.417 0 .418.01.725.03.92.02.18.057.314.107.396.046.075.093.117.14.134.075.027.218.056.42.083a.855.855 0 0 1 .56.297c.145.167.215.38.215.636 0 .612-.432.934-1.216.934-.457 0-.87-.087-1.233-.262a1.995 1.995 0 0 1-.853-.751 2.09 2.09 0 0 1-.305-1.097c-.014-.648-.029-1.168-.043-1.56-.013-.383-.034-.631-.06-.733-.064-.263-.158-.455-.276-.578a2.163 2.163 0 0 0-.505-.376c-.238-.134-.41-.256-.519-.371C.058 6.76 0 6.567 0 6.315c0-.37.166-.657.493-.846.329-.186.56-.342.693-.466a.942.942 0 0 0 .26-.447c.056-.2.088-.42.097-.658.01-.25.024-.85.043-1.802.015-.629.239-1.14.672-1.522C2.691.19 3.268 0 3.977 0c.783 0 1.216.317 1.216.921 0 .264-.069.48-.211.643a.858.858 0 0 1-.563.29c-.249.03-.417.076-.498.126-.062.04-.112.134-.139.291-.031.187-.052.562-.061 1.119a8.828 8.828 0 0 1-.112 1.378 2.24 2.24 0 0 1-.404.963c-.159.212-.373.406-.64.583.25.163.454.342.612.538zm7.34 0c.157-.196.362-.375.612-.538a2.544 2.544 0 0 1-.641-.583 2.24 2.24 0 0 1-.404-.963 8.828 8.828 0 0 1-.112-1.378c-.009-.557-.03-.932-.061-1.119-.027-.157-.077-.251-.14-.29-.08-.051-.248-.096-.496-.127a.858.858 0 0 1-.564-.29C8.57 1.401 8.5 1.185 8.5.921 8.5.317 8.933 0 9.716 0c.71 0 1.286.19 1.72.574.432.382.656.893.671 1.522.02.952.033 1.553.043 1.802.009.238.041.458.097.658a.942.942 0 0 0 .26.447c.133.124.364.28.693.466a.926.926 0 0 1 .493.846c0 .252-.058.446-.183.58-.109.115-.281.237-.52.371-.21.118-.377.244-.504.376-.118.123-.212.315-.277.578-.025.102-.045.35-.06.733-.013.392-.027.912-.042 1.56a2.09 2.09 0 0 1-.305 1.097c-.2.323-.486.574-.853.75a2.811 2.811 0 0 1-1.233.263c-.784 0-1.216-.322-1.216-.934 0-.256.07-.47.214-.636a.855.855 0 0 1 .562-.297c.201-.027.344-.056.418-.083.048-.017.096-.06.14-.134a.996.996 0 0 0 .107-.396c.02-.195.031-.502.031-.92 0-.573.039-1.045.117-1.417.08-.382.222-.701.427-.954z" /> </svg>',title:"Code"}}static get DEFAULT_PLACEHOLDER(){return"Enter code"}static get pasteConfig(){return{tags:["pre"]}}static get sanitize(){return{code:!0}}tabHandler(e){e.stopPropagation(),e.preventDefault();const t=e.target,a=e.shiftKey,n=t.selectionStart,i=t.value,o="  ";let s;if(a){const e=function(e,t){let a="";for(;"\n"!==a&&t>0;)t-=1,a=e.substr(t,1);return"\n"===a&&(t+=1),t}(i,n);if(i.substr(e,o.length)!==o)return;t.value=i.substring(0,e)+i.substring(e+o.length),s=n-o.length}else s=n+o.length,t.value=i.substring(0,n)+o+i.substring(n);t.setSelectionRange(s,s)}}class k{static get isReadOnlySupported(){return!0}static get toolbox(){return{icon:'<svg width="15" height="14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M358.182 179.361c-19.493-24.768-52.679-31.945-79.872-19.098-15.127-15.687-36.182-22.487-56.595-19.629V67c0-36.944-29.736-67-66.286-67S89.143 30.056 89.143 67v161.129c-19.909-7.41-43.272-5.094-62.083 8.872-29.355 21.795-35.793 63.333-14.55 93.152l109.699 154.001C134.632 501.59 154.741 512 176 512h178.286c30.802 0 57.574-21.5 64.557-51.797l27.429-118.999A67.873 67.873 0 0 0 448 326v-84c0-46.844-46.625-79.273-89.818-62.639zM80.985 279.697l27.126 38.079c8.995 12.626 29.031 6.287 29.031-9.283V67c0-25.12 36.571-25.16 36.571 0v175c0 8.836 7.163 16 16 16h6.857c8.837 0 16-7.164 16-16v-35c0-25.12 36.571-25.16 36.571 0v35c0 8.836 7.163 16 16 16H272c8.837 0 16-7.164 16-16v-21c0-25.12 36.571-25.16 36.571 0v21c0 8.836 7.163 16 16 16h6.857c8.837 0 16-7.164 16-16 0-25.121 36.571-25.16 36.571 0v84c0 1.488-.169 2.977-.502 4.423l-27.43 119.001c-1.978 8.582-9.29 14.576-17.782 14.576H176c-5.769 0-11.263-2.878-14.697-7.697l-109.712-154c-14.406-20.223 14.994-42.818 29.394-22.606zM176.143 400v-96c0-8.837 6.268-16 14-16h6c7.732 0 14 7.163 14 16v96c0 8.837-6.268 16-14 16h-6c-7.733 0-14-7.163-14-16zm75.428 0v-96c0-8.837 6.268-16 14-16h6c7.732 0 14 7.163 14 16v96c0 8.837-6.268 16-14 16h-6c-7.732 0-14-7.163-14-16zM327 400v-96c0-8.837 6.268-16 14-16h6c7.732 0 14 7.163 14 16v96c0 8.837-6.268 16-14 16h-6c-7.732 0-14-7.163-14-16z"></path></svg>',title:"Button"}}static get contentless(){return!0}static get enableLineBreaks(){return!1}static get DEFAULT_TEXT_PLACEHOLDER(){return"Click me!"}static get DEFAULT_URL_PLACEHOLDER(){return"https://mailcoach.app"}static get conversionConfig(){return{import:"text",export:function(e){return e.url?`${e.text} — ${e.url}`:e.text}}}get CSS(){return{baseClass:this.api.styles.block,wrapper:"cdx-button",text:"cdx-button__text",input:this.api.styles.input,url:"cdx-button__url"}}constructor({data:e,config:t,api:a,readOnly:n}){this.api=a,this.readOnly=n,this.buttonPlaceholder=t.buttonPlaceholder||k.DEFAULT_TEXT_PLACEHOLDER,this.urlPlaceholder=t.urlPlaceholder||k.DEFAULT_URL_PLACEHOLDER,this.data={text:e.text||"",url:e.url||""}}render(){const e=this._make("div",[this.CSS.baseClass,this.CSS.wrapper],{style:"text-align: left; margin-bottom: 10px;"}),t=this._make("div",["mb-2"],{innerHTML:"Button",style:"font-weight: bold;"});e.appendChild(t);const a=this._make("div",["flex","items-center"]),n=this._make("label",["mr-2","w-16"],{innerHTML:"Text:"}),i=this._make("div",[this.CSS.input,this.CSS.text],{contentEditable:!this.readOnly,innerHTML:this.data.text});a.appendChild(n),a.appendChild(i);const o=this._make("div",["flex","items-center"]),s=this._make("label",["mr-2","w-16"],{innerHTML:"Url:"}),r=this._make("div",[this.CSS.input,this.CSS.url],{contentEditable:!this.readOnly,innerHTML:this.data.url});return o.appendChild(s),o.appendChild(r),i.dataset.placeholder=this.buttonPlaceholder,r.dataset.placeholder=this.urlPlaceholder,e.appendChild(a),e.appendChild(o),e}save(e){const t=e.querySelector(`.${this.CSS.text}`),a=e.querySelector(`.${this.CSS.url}`);return Object.assign(this.data,{text:t.innerHTML,url:a.innerHTML})}static get sanitize(){return{text:{br:!1},url:{br:!1}}}_make(e,t=null,a={}){const n=document.createElement(e);Array.isArray(t)?n.classList.add(...t):t&&n.classList.add(t);for(const i in a)n[i]=a[i];return n}}function C(e){document.getElementById("html")&&("dirty"!==document.getElementById("html").dataset.dirty||confirm("Are you sure you want to leave this page? Any unsaved changes will be lost.")?(document.removeEventListener("turbolinks:before-visit",C),window.removeEventListener("beforeunload",C),window.editor.destroy(),window.editor=void 0):e.preventDefault())}function S(){document.addEventListener("turbolinks:before-visit",C),document.addEventListener("turbolinks:load",S),window.addEventListener("beforeunload",C);const c=l("#editor-js");if(!c||void 0!==window.editor)return;let u=c.dataset.structuredHtml?JSON.parse(c.dataset.structuredHtml):void 0;window.editor=new e({holder:c,autofocus:!0,data:u,tools:{header:t,list:{class:a,inlineToolbar:!0},image:{class:n,config:{uploader:{uploadByFile(e){const t=new FormData;return t.append("file",e),b(c.dataset.upload,t)},uploadByUrl(e){const t=new FormData;return t.append("url",e),b(c.dataset.upload,t)}}}},quote:i,delimiter:o,raw:s,table:{class:r},code:y,button:k,inlineCode:{class:d,shortcut:"CMD+SHIFT+M"}},onChange:()=>{document.getElementById("html").dataset.dirty="dirty"}}),l("#save").addEventListener("click",(e=>{e.preventDefault(),window.editor.save().then((e=>{f(c.dataset.route,{body:e,template:l("#template").value}).then((t=>{document.getElementById("html").value=t,document.getElementById("body").value=JSON.stringify(e),document.getElementById("html").dataset.dirty="",document.querySelector("main form").submit()})).catch((e=>{console.log("Saving failed: ",e)}))})).catch((e=>{console.log("Saving failed: ",e)}))})),l("#preview").addEventListener("click",(e=>{e.preventDefault(),window.editor.save().then((e=>{f(c.dataset.route,{body:e,template:l("#template").value}).then((e=>{l("#html").value=e;const t=document.createEvent("Event");t.initEvent("input",!0,!0),document.getElementById("html").dispatchEvent(t),w("preview")}))}))})),l('[data-modal-trigger="edit-template"]').addEventListener("click",(()=>{document.getElementById("structured_html[template]").value=l("#template").value})),l('[data-modal-confirm="edit-template"]').addEventListener("click",(()=>{l("#template").value=document.getElementById("structured_html[template]").value}))}document.addEventListener("turbolinks:load",S),document.addEventListener("load",S),document.addEventListener("before-visit",C),window.addEventListener("beforeunload",C),S();
